<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>eRTK: eRTK/eRTK.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">eRTK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_7f9efb1b529886138cfa1451d855f278.html">eRTK</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">eRTK.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="e_r_t_k_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * eRTK.cpp</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Created: 13.04.2015 07:52:46</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  Author: er</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span> </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;avr/io.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;avr/interrupt.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;avr/sleep.h&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;avr/wdt.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="e_r_t_k_8h.html">eRTK.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="adc_8h.html">adc.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#ifdef ERTKDEBUG</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;uint8_t stack[<a class="code" href="e_r_t_k_8h.html#ab3cb102afd3b038d1a336dfebb4521ea">VANZTASK</a>+1][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>]  <a class="code" href="e_r_t_k_8c.html#a023ca68d8f937e79d0a90d22144fe3a1">__attribute__</a> ((aligned (256)));  <span class="comment">/* Jede Task hat Stack a&#39; STACKSIZE Byte */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;uint8_t stack[<a class="code" href="e_r_t_k_8h.html#ab3cb102afd3b038d1a336dfebb4521ea">VANZTASK</a>+1][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>];  <span class="comment">/* Jede Task hat Stack a&#39; STACKSIZE Byte */</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a8d80a94387da2f651c867b136f13e585">   22</a></span>&#160;<span class="keywordtype">void</span> * <a class="code" href="e_r_t_k_8c.html#a8d80a94387da2f651c867b136f13e585">stackptr</a>[<a class="code" href="e_r_t_k_8h.html#ab3cb102afd3b038d1a336dfebb4521ea">VANZTASK</a>+1]; <span class="comment">/* Ablage fuer Stackpointer der Tasks */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a36551d0cc20561200d962fd673baf747">   24</a></span>&#160;<span class="keyword">volatile</span> uint8_t <a class="code" href="e_r_t_k_8c.html#a36551d0cc20561200d962fd673baf747">akttask</a>;    <span class="comment">/* Nummer der aktuellen Task, 0=idle */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/* struktur task control block */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="structs__tcd.html">   27</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structs__tcd.html">s_tcd</a> {    <span class="comment">/* queue mit ordnungskriterium task prioritaet 255..0 */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">   28</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs__tcd.html">s_tcd</a> * <a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>;   <span class="comment">/* 1. element immer verkettungszeiger !!! */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">   29</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structs__tcd.html">s_tcd</a> * <a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>; <span class="comment">/* vorgaenger in liste */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">   30</a></span>&#160;  uint8_t <a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a>;            <span class="comment">/* index aus der reihenfolge der statischen deklaration */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structs__tcd.html#acc0b27a6740f03639727be452f1e6b83">   31</a></span>&#160;  uint8_t <a class="code" href="structs__tcd.html#acc0b27a6740f03639727be452f1e6b83">prio</a>;           <span class="comment">/* 0..255 */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="structs__tcd.html#a0ff73b1428e9cd11a4f7a6cf46b7b550">   32</a></span>&#160;  uint8_t <a class="code" href="structs__tcd.html#a0ff73b1428e9cd11a4f7a6cf46b7b550">timer</a>;          <span class="comment">/* timeout counter mit system tick aufloesung */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#ifdef ERTK_DEBUG</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  uint16_t param0;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">void</span> * param1;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; } <a class="code" href="e_r_t_k_8c.html#aa6f1a6f9166129ed5bd9dc8989cb0dbe">s_tcd</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a41c229f999d1607dd3f54b7d0b8a18cc">   38</a></span>&#160;<a class="code" href="structs__tcd.html">s_tcd</a> <a class="code" href="e_r_t_k_8c.html#a41c229f999d1607dd3f54b7d0b8a18cc">tcd</a>[<a class="code" href="e_r_t_k_8h.html#ab3cb102afd3b038d1a336dfebb4521ea">VANZTASK</a>+1];    <span class="comment">/* indizierung ueber task index */</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a61c66c5448e8a03934ca76279b767b2a">   40</a></span>&#160;<a class="code" href="structs__tcd.html">s_tcd</a> * <a class="code" href="e_r_t_k_8c.html#a61c66c5448e8a03934ca76279b767b2a">pTaskRdy</a>;         <span class="comment">/* einfache verkettung aller ready tasks ueber tcd.next in reihenfolge der prioritaet */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">  die perfcounter: </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">  stellen in einem schieberegister die letzten 256 messergebnisse dar.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">  bei system im leerlauf stehen die zaehler auf 1000-overhead.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">  eine schleife dauert 16 zyklen, alle 1ms wird abgefragt und da sind 16000 zyklen ausgefuehrt worden.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">  je mehr systemlast um so kleiner der zaehlerstand.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">  1000 -&gt; leerlauf</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">   900 -&gt; 100*16=1600 zyklen wurden anderweitig verbraucht (in diesem 1ms intervall)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">  ! z.b. lcd_clear_area() braucht mehr als 10ms !</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a26b5f9d5385bb6bc6cb37ef2b654658a">   52</a></span>&#160;<span class="keyword">volatile</span> uint8_t  <a class="code" href="e_r_t_k_8c.html#a26b5f9d5385bb6bc6cb37ef2b654658a">eRTK_up</a>;               <span class="comment">//wird gesetzt wenn das system gestartet ist</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a8fe81059bd63b9c331b9cef3af5592ac">   53</a></span>&#160;<span class="keyword">volatile</span> uint16_t <a class="code" href="e_r_t_k_8c.html#a8fe81059bd63b9c331b9cef3af5592ac">eRTK_perfcount</a>;        <span class="comment">//aktueller counter</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#aab934edff3f692e18b7a5f6d1a5c6f80">   54</a></span>&#160;<span class="keyword">volatile</span> uint16_t <a class="code" href="e_r_t_k_8c.html#aab934edff3f692e18b7a5f6d1a5c6f80">eRTK_perfcounter</a>[256]; <span class="comment">//counter array der letzen 256ms</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a6c892b8dd5b4f853e95f4b0646d299e6">   55</a></span>&#160;<span class="keyword">volatile</span> uint8_t  <a class="code" href="e_r_t_k_8c.html#a6c892b8dd5b4f853e95f4b0646d299e6">eRTK_iperf</a>;            <span class="comment">//index im array 0..255</span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a4800cc7a9b075006ac86ec1cfb1e3988">   56</a></span>&#160;<span class="keyword">volatile</span> uint16_t <a class="code" href="e_r_t_k_8c.html#a4800cc7a9b075006ac86ec1cfb1e3988">eRTK_ticks</a>;            <span class="comment">//wie spaet ist es nach dem urknall in ms</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a05d77a5f8b9d931a0263a9c07e21f20b">   57</a></span>&#160;<span class="keyword">volatile</span> uint8_t  <a class="code" href="e_r_t_k_8c.html#a05d77a5f8b9d931a0263a9c07e21f20b">eRTK_cnt_overload</a>;     <span class="comment">//zaehlt die aufeinanderfolgenden overload phasen</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#ab5dfbb4f8786173b65bc8728b1dd4b59">   59</a></span>&#160;<span class="keywordtype">void</span>  <a class="code" href="e_r_t_k_8c.html#a023ca68d8f937e79d0a90d22144fe3a1">__attribute__</a> ((optimize(<span class="stringliteral">&quot;O2&quot;</span>))) eRTK_Idle( <span class="keywordtype">void</span> ) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#ifdef ERTKDEBUG</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">while</span>( 1 ) {           <span class="comment">//14+2=16 cycles pro loop -&gt; 16MHz -&gt; 1000 inc/ms</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    cli();               <span class="comment">//cli=1clock</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    ++<a class="code" href="e_r_t_k_8c.html#a8fe81059bd63b9c331b9cef3af5592ac">eRTK_perfcount</a>;    <span class="comment">//lds,lds,adiw,sts,sts=5x2clocks</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    sei();               <span class="comment">//sei=1clock</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="e_r_t_k_8h.html#a015273ea14d0c2a5a1a41fa4189ef151">oIDLEfast</a>( 1 );      <span class="comment">//2 cycles fuer 2xnop oder ein output bit setzen</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   }                     <span class="comment">//rjmp=2clocks</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">while</span>( 1 ) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    set_sleep_mode( SLEEP_MODE_IDLE );</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    sleep_enable();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    sei();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="e_r_t_k_8h.html#a3d61c5457dc8a3e2905d426f3581207e">oIDLE</a>( 1 );</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    sleep_cpu();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    sleep_disable();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#ad62826e478a753740ffb406eeb04f274">   80</a></span>&#160;<a class="code" href="e_r_t_k_8c.html#a023ca68d8f937e79d0a90d22144fe3a1">__attribute__</a> ((noinline)) void <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77">tsys</a> reason ) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">while</span>( 1 );</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a6f37965512a76bfcf60c294b780f1fe0">   85</a></span>&#160;<span class="keywordtype">void</span> * <a class="code" href="e_r_t_k_8c.html#a6f37965512a76bfcf60c294b780f1fe0">pp_stack</a>; <span class="comment">//speicher f�r stackpointer w�hrend push/pop</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//push pc, push r0, r0&lt;-sreg, push r0..r31</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#ae325ea7e04e372ce84d5b9bcbc86bd1c">   87</a></span>&#160;<span class="preprocessor">#define push() { \</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">  asm volatile ( \</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">  &quot;push r0\n&quot;</span><span class="comment">/*push r0*/</span><span class="preprocessor"> \</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">  &quot;in   r0, __SREG__\n&quot; \</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">  &quot;cli\n&quot; </span><span class="comment">/*push sreg, push r1..r31 */</span><span class="preprocessor">\ </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="stringliteral">&quot;push  r0\npush  r1\npush  r2\npush  r3\npush  r4\npush  r5\npush  r6\npush  r7\npush  r8\npush  r9\npush r10\npush   r11\npush   r12\npush   r13\npush   r14\npush   r15\npush   r16\npush   r17\npush   r18\npush   r19\npush   r20\npush   r21\npush   r22\npush   r23\npush   r24\npush   r25\npush   r26\npush   r27\npush   r28\npush   r29\npush   r30\npush   r31\n&quot;</span> \</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#aa12b3e98802f8da0bed40aa8a2912d11">   93</a></span>&#160;  <span class="stringliteral">&quot;in       r0, __SP_L__\n&quot;</span> \</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="stringliteral">&quot;sts  pp_stack, r0\n&quot;</span> \</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="stringliteral">&quot;in       r0, __SP_H__\n&quot;</span> \</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="stringliteral">&quot;sts  pp_stack+1, r0\n&quot;</span> \</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  ); \</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//pop r31 .. r0, sreg&lt;-r0, pop r0</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#abfba97ff1c115a2b0c3911c0c781f697">  101</a></span>&#160;<span class="preprocessor">#define pop() { \</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">  asm volatile ( \</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">  &quot;lds r0, pp_stack \n&quot; \</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">  &quot;out __SP_L__, r0 \n&quot; \</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">  &quot;lds r0, pp_stack+1\n&quot; \</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">  &quot;out __SP_H__, r0\n&quot; \</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">  </span><span class="comment">/*pop r31..sreg*/</span><span class="preprocessor"> \</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">    &quot;pop    r31\npop    r30\npop    r29\npop    r28\npop    r27\npop    r26\npop    r25\npop    r24\npop    r23\npop    r22\npop    r21\npop    r20\npop    r19\npop    r18\npop    r17\npop    r16\npop    r15\npop    r14\npop    r13\npop    r12\npop    r11\npop    r10\npop     r9\npop     r8\npop     r7\npop     r6\npop     r5\npop     r4\npop     r3\npop     r2\npop     r1\npop     r0\n&quot; \</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">    &quot;out    __SREG__, r0\n&quot; \</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">    &quot;pop    r0\n&quot;</span><span class="comment">/*pop r0*/</span><span class="preprocessor"> \</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">  &quot;sei\n&quot; \</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">  ); \</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor"> }</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#a4c664627999740245c2a31dc34f150cc">  115</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#a023ca68d8f937e79d0a90d22144fe3a1">__attribute__</a> ((naked)) eRTK_scheduler( <span class="keywordtype">void</span> ) { <span class="comment">/* start der hoechstprioren ready task, notfalls idle */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="e_r_t_k_8c.html#ae325ea7e04e372ce84d5b9bcbc86bd1c">push</a>();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  stackptr[<a class="code" href="e_r_t_k_8c.html#a36551d0cc20561200d962fd673baf747">akttask</a>]=<a class="code" href="e_r_t_k_8c.html#a6f37965512a76bfcf60c294b780f1fe0">pp_stack</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span>( pTaskRdy ) { <span class="comment">//da muss natuerlich immer was drinstehen ;)</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">//do round robin bei mehreren mit gleicher prio</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="structs__tcd.html">s_tcd</a> *p=<a class="code" href="e_r_t_k_8c.html#a61c66c5448e8a03934ca76279b767b2a">pTaskRdy</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">while</span>( p-&gt;<a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a> != akttask ) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      p=p-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>; <span class="comment">//finde aktuelle task</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">if</span>( !p ) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span>( p ) { <span class="comment">//task stand noch in der ready liste</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">//teste pri des nachfolgers</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span>( p-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>!=NULL ) { <span class="comment">//wenn es nachfolger gibt</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">if</span>( p-&gt;<a class="code" href="structs__tcd.html#acc0b27a6740f03639727be452f1e6b83">prio</a> == p-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>-&gt;<a class="code" href="structs__tcd.html#acc0b27a6740f03639727be452f1e6b83">prio</a> ) { <span class="comment">//schalte weiter wenn nachfolger prio genauso ist</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          akttask=p-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>-&gt;<a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;         }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          akttask=pTaskRdy-&gt;<a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;         }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;       }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">else</span> { <span class="comment">//sonst nimm den ersten in der liste, der muss per definition die gleiche prio haben da wir bei kleineren prios gar nicht suchen !</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        akttask=pTaskRdy-&gt;<a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;       }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;     }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">else</span> akttask=pTaskRdy-&gt;<a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a>; <span class="comment">//nimm das erstbeste aus der ready liste ;)</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">else</span> <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77aae3becb60d64378eb6639c6e0f3ad24b">SYS_NOTASK</a> );</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="e_r_t_k_8c.html#a6f37965512a76bfcf60c294b780f1fe0">pp_stack</a>=stackptr[<a class="code" href="e_r_t_k_8c.html#a36551d0cc20561200d962fd673baf747">akttask</a>];</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="e_r_t_k_8c.html#abfba97ff1c115a2b0c3911c0c781f697">pop</a>();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  sei();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keyword">asm</span> <span class="keyword">volatile</span> ( <span class="stringliteral">&quot;ret&quot;</span> );</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#a42910d588a38ca0fca7d0897a715fdad">  151</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#a42910d588a38ca0fca7d0897a715fdad">eRTK_go</a>( <span class="keywordtype">void</span> ) { <span class="comment">/* start der hoechstprioren ready task, notfalls idle */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">if</span>( pTaskRdy ) akttask=pTaskRdy-&gt;<a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">else</span> <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77aae3becb60d64378eb6639c6e0f3ad24b">SYS_NOTASK</a> );</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  eRTK_up=1;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="e_r_t_k_8c.html#a6f37965512a76bfcf60c294b780f1fe0">pp_stack</a>=stackptr[<a class="code" href="e_r_t_k_8c.html#a36551d0cc20561200d962fd673baf747">akttask</a>];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="e_r_t_k_8c.html#abfba97ff1c115a2b0c3911c0c781f697">pop</a>();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keyword">asm</span> <span class="keyword">volatile</span>( <span class="stringliteral">&quot;ret&quot;</span> );</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">/* Prinzip der Ready Liste:</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> * pTskRdy ist nie 0 und zeigt zumindest auf den tcd[0]==idle task.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> * wenn eine task bereit wird geschieht dies durch einhaengen in die liste</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> * und zwar vor der ersten task mit niedrigerer prio.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> * zunaechst also pTskRdy-&gt;tcd[0]-&gt;0 wird pTskRdy-&gt;tcd[x]-&gt;tcd[0]-&gt;0 ( falls tcd[x].prio&gt;0 )</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> * wenn tcd[y].prio &gt; tcd[x].prio dann pTskRdy-&gt;tcd[y]-&gt;tcd[x]-&gt;tcd[0]-&gt;0</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> * sonst pTskRdy-&gt;tcd[x]-&gt;tcd[y]-&gt;0</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> * usw.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> * Der scheduler sucht immer ob tcd[akttask] noch in der liste steht.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> *   wenn nein, nimmt er den ersten eintrag der liste zum start ( highest prio task always runs )</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> *   wenn ja, schaut er nach ob der nachfolger gleiche pri hat. ( round robin )</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> *     wenn ja nimmt er diesen ( weiterschaltung in prio ebene )</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> *     wenn nein nimmt er den ersten eintrag der liste ( das ist ja immer der mit der hoechsten prio )</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> *  Ausgangszustand nur mit idle task:</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> *  pTsk--&gt;tcd[0]</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> *         pnext=0</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"> *         pbefore=0</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> *  task 2 dazu mit insertat( this=&amp;tcd[0], new=&amp;tcd[2] )</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> *         new          this</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> *  pTsk--&gt;tcd[2]       tcd[0]</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> *         pnext-------&gt;pnext=0</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> *         pbefore=0 &lt;--pbefore  </span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> *              </span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"> *  task 1 dazu mit insertat( this=&amp;tcd[0], new=&amp;tcd[1] )</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> *                      new          this</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> *  pTsk--&gt;tcd[2]       tcd[1]       tcd[0]</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> *         pnext-------&gt;pnext-------&gt;pnext=0</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> *         pbefore=0 &lt;--pbefore&lt;-----pbefore</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> *                   </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keyword">static</span> __inline__ <span class="keywordtype">void</span> insertat( <a class="code" href="structs__tcd.html">s_tcd</a> *pthis, <a class="code" href="structs__tcd.html">s_tcd</a> *newone ) { <span class="comment">//newone vor pthis eintragen</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">if</span>( !pthis || !newone ) <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a8581699208d8eafcc5cbd0b62b932765">SYS_NULLPTR</a> );</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  ATOMIC_BLOCK( ATOMIC_RESTORESTATE ) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span>( pthis-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a> == NULL ) { <span class="comment">//der erste tcd</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      pTaskRdy=newone;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      newone-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>=NULL;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;     }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">else</span> { <span class="comment">//tcd in der kette</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      pthis-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>=newone;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      newone-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>=pthis-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;     }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    newone-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>=pthis;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    pthis-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>=newone;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keyword">static</span> __inline__ <span class="keywordtype">void</span> removeat( <a class="code" href="structs__tcd.html">s_tcd</a> *pthis ) { <span class="comment">//den node pthis austragen</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  ATOMIC_BLOCK( ATOMIC_RESTORESTATE ) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span>( pthis==NULL || pthis==&amp;tcd[0] ) { <span class="comment">//0 oder idle task</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a8581699208d8eafcc5cbd0b62b932765">SYS_NULLPTR</a> );</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;     }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span>( pthis-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>==NULL ) { <span class="comment">//es ist der erste block auf den pTskReady zeigt</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">if</span>( pthis-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>==NULL ) { <span class="comment">//und er hat keinen nachfolger den man vorziehen kann</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a8581699208d8eafcc5cbd0b62b932765">SYS_NULLPTR</a> );</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;       }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      pTaskRdy=pthis-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>; <span class="comment">//nachfolger einhaengen</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      pthis-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>=NULL;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;     }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">else</span> { <span class="comment">//mittendrin in der kette</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      pthis-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>=pthis-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      pthis-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>=pthis-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;     } </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    pthis-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>=NULL; <span class="comment">//diesen block aus verkettung nehmen</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    pthis-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>=NULL;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; }  </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#a09970f0903edf40a2a54074eebc038e6">  233</a></span>&#160;uint8_t <a class="code" href="e_r_t_k_8c.html#a09970f0903edf40a2a54074eebc038e6">eRTK_GetTid</a>( <span class="keywordtype">void</span> ) { <span class="comment">//holen der eigenen task id</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="e_r_t_k_8c.html#a36551d0cc20561200d962fd673baf747">akttask</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">//Verwaltung der ready list mit einfuegen/ausfuegen in der reihenfolge der prio</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#a7ea5f3e666d805502c0f77d8e1cb7915">  238</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#a7ea5f3e666d805502c0f77d8e1cb7915">eRTK_SetReady</a>( uint8_t <a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a> ) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span>( !tid ) <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a8581699208d8eafcc5cbd0b62b932765">SYS_NULLPTR</a> ); <span class="comment">//idle task ist immer ready</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span>( tcd[tid].<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a> || tcd[tid].<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a> ) <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a887fd82bac500521b5e2e0d10cc1ba40">SYS_VERIFY</a> ); <span class="comment">//war gar nicht suspendiert</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <a class="code" href="structs__tcd.html">s_tcd</a> *pthis=<a class="code" href="e_r_t_k_8c.html#a61c66c5448e8a03934ca76279b767b2a">pTaskRdy</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  ATOMIC_BLOCK( ATOMIC_RESTORESTATE ) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    tcd[<a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a>].<a class="code" href="structs__tcd.html#a0ff73b1428e9cd11a4f7a6cf46b7b550">timer</a>=0; <span class="comment">//timer loeschen damit er nicht spaeter nochmal startet</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">do</span> { <span class="comment">//pthis-&gt;hoechstprioren tcd oder idle</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">if</span>( tcd[tid].<a class="code" href="structs__tcd.html#acc0b27a6740f03639727be452f1e6b83">prio</a> &gt; pthis-&gt;<a class="code" href="structs__tcd.html#acc0b27a6740f03639727be452f1e6b83">prio</a> || pthis-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>==NULL ) { <span class="comment">//neuer eintrag hat hoehere prio oder es gibt keinen nachfolger</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        insertat( pthis, &amp;tcd[tid] );</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;       }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;     } <span class="keywordflow">while</span>( ( pthis=pthis-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a> ) );</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">//pTskRdy-&gt;tcdx-&gt;tcdy-&gt;0 es muss immer mindestens ein tcd (idle) in der liste bleiben</span></div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#aa63d7b8eeb6b2a9b10664b54f6e78e55">  255</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#aa63d7b8eeb6b2a9b10664b54f6e78e55">eRTK_SetSuspended</a>( uint8_t <a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a> ) { <span class="comment">//tcd[tid] aus der ready list austragen</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">if</span>( !tid ) <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a8581699208d8eafcc5cbd0b62b932765">SYS_NULLPTR</a> ); <span class="comment">//idle task darf nicht suspendiert werden</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">if</span>( !tcd[tid].<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a> &amp;&amp; !tcd[tid].<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a> ) <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a887fd82bac500521b5e2e0d10cc1ba40">SYS_VERIFY</a> ); <span class="comment">//war nicht in ready list</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="structs__tcd.html">s_tcd</a> *pthis=<a class="code" href="e_r_t_k_8c.html#a61c66c5448e8a03934ca76279b767b2a">pTaskRdy</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  ATOMIC_BLOCK( ATOMIC_RESTORESTATE ) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">if</span>( pthis-&gt;<a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a>==tid ) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        removeat( pthis );</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;       }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     } <span class="keywordflow">while</span>( ( pthis=pthis-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a> ) );</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#a3d802070bf824d2fadeda7297e158d32">  269</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#a3d802070bf824d2fadeda7297e158d32">eRTK_wefet</a>( uint8_t timeout ) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span>( timeout ) { <span class="comment">//sonst klinkt sich die task in einem wait_until() fuer immer aus</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    ATOMIC_BLOCK( ATOMIC_RESTORESTATE ) { <span class="comment">//14+2=16 cycles pro loop -&gt; 16MHz -&gt; 1000 inc/ms</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">if</span>( tcd[akttask].<a class="code" href="structs__tcd.html#a0ff73b1428e9cd11a4f7a6cf46b7b550">timer</a> ) <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a527512c0cf5a8a3ae6a2f83d31764467">SYS_UNKNOWN</a> );</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      tcd[<a class="code" href="e_r_t_k_8c.html#a36551d0cc20561200d962fd673baf747">akttask</a>].<a class="code" href="structs__tcd.html#a0ff73b1428e9cd11a4f7a6cf46b7b550">timer</a>=timeout;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="e_r_t_k_8c.html#aa63d7b8eeb6b2a9b10664b54f6e78e55">eRTK_SetSuspended</a>( akttask );</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      eRTK_scheduler();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;     }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#ac0c35182aeab65219bdf56d0f7d37aa0">  280</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#ac0c35182aeab65219bdf56d0f7d37aa0">eRTK_Sleep_ms</a>( uint16_t ms ) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">while</span>( ms ) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span>( ms&gt;255 ) { </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <a class="code" href="e_r_t_k_8c.html#a3d802070bf824d2fadeda7297e158d32">eRTK_wefet</a>( 255 ); </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      ms-=255; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;     }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <a class="code" href="e_r_t_k_8c.html#a3d802070bf824d2fadeda7297e158d32">eRTK_wefet</a>( ms );</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      ms=0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;     }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">//semaphoren</span></div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#ac1f7652b7dcfdf546cc32354bc65274c">  294</a></span>&#160;<span class="preprocessor">#define ANZSEMA 10</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keyword">static</span> uint8_t sema[<a class="code" href="e_r_t_k_8c.html#ac1f7652b7dcfdf546cc32354bc65274c">ANZSEMA</a>];</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="e_r_t_k_8c.html#a023ca68d8f937e79d0a90d22144fe3a1">__attribute__</a>((__always_inline__)) uint8_t xch ( uint8_t volatile *p, uint8_t x ) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">//wenn die cpu xch kennt:</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// __asm volatile (&quot;xch %a1,%0&quot; : &quot;+r&quot;(x) : &quot;z&quot;(p) : &quot;memory&quot;);</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keyword">register</span> uint8_t tmp;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  ATOMIC_BLOCK( ATOMIC_RESTORESTATE ) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    tmp=*p;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    *p=x;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">//return x;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#a1760711232ae117710d963736158d5b1">  309</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#a1760711232ae117710d963736158d5b1">eRTK_get_sema</a>( uint8_t semaid ) { <span class="comment">/* Warten bis Semaphore frei ist und danach besetzen */</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">if</span>( semaid&gt;=<a class="code" href="e_r_t_k_8c.html#ac1f7652b7dcfdf546cc32354bc65274c">ANZSEMA</a> ) <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a527512c0cf5a8a3ae6a2f83d31764467">SYS_UNKNOWN</a> );</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">while</span>( xch( &amp;sema[semaid], 1 ) ) { <span class="comment">/* &gt;0 = sema blockiert */</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    sei();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="e_r_t_k_8c.html#a3d802070bf824d2fadeda7297e158d32">eRTK_wefet</a>( 1 );</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a17cb0c621d1b778f1d2ea451ee05b5d5">  317</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#a17cb0c621d1b778f1d2ea451ee05b5d5">eRTK_free_sema</a>( uint8_t semaid ) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">if</span>( semaid&gt;=<a class="code" href="e_r_t_k_8c.html#ac1f7652b7dcfdf546cc32354bc65274c">ANZSEMA</a> ) <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a527512c0cf5a8a3ae6a2f83d31764467">SYS_UNKNOWN</a> );</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  xch( &amp;sema[semaid], 0 ) ;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#ac4ea8d578bfd6abe49586e1f0c502855">  322</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#ac4ea8d578bfd6abe49586e1f0c502855">sema_init</a>( <span class="keywordtype">void</span> ) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keyword">static</span> uint8_t <a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">for</span>( n=0; n&lt;<a class="code" href="e_r_t_k_8c.html#ac1f7652b7dcfdf546cc32354bc65274c">ANZSEMA</a>; n++ ) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    sema[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>]=0; <span class="comment">/* ff=keine task wartend */</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">stck[n][STACKSIZE]</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">- 1-+</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">- 2 |deadbeef() bei return aus der task zurueck</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">- 3-+</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">- 4-+</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">- 5 |task()</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">- 6-+</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">- 7 r0</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">- 8 SREG</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">- 9 r1</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">-10 r2</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">-11 r3</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">-12 r4</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">-13 r5</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">-14 r6</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">-15 r7</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">-16 r8</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">-17 r9</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">-18 r10</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">-19 r11</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">-20 r12</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">-21 r13</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">-22 r14</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">-23 r15</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">-24 r16</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">-25 r17</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">-26 r18</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">-27 r19</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">-28 r20</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">-29 r21</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">-30 r22-+</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">-31 r23-+param1</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">-32 r24-+</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">-33 r25-+param0</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">-34 r26</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">-35 r27</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">-36 r28</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">-37 r29</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">-38 r30</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">-39 r31     </span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#a3631624090b7ea09b3a64993b9c979e7">  371</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#a3631624090b7ea09b3a64993b9c979e7">eRTK_init</a>( <span class="keywordtype">void</span> ) { <span class="comment">/* Initialisierung der Daten des Echtzeitsystems */</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  uint8_t <a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>, <a class="code" href="structs__tcd.html#acc0b27a6740f03639727be452f1e6b83">prio</a>, index;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  uint8_t task;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">for</span>( n=0; n&lt;<a class="code" href="e_r_t_k_8h.html#ab3cb102afd3b038d1a336dfebb4521ea">VANZTASK</a>+1; n++ ) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    tcd[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>].<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>=NULL; <span class="comment">/* verkettung der tcd&#39;s in unsortiertem grundzustand */</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    tcd[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>].<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>=NULL;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    tcd[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>].<a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a>=<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    tcd[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>].<a class="code" href="structs__tcd.html#acc0b27a6740f03639727be452f1e6b83">prio</a>=n ? <a class="code" href="e_r_t_k_8h.html#a975060be934fd5e6530ed4ddd6d17eee">rom_tcb</a>[n-1].<a class="code" href="structt__e_r_t_k__tcb.html#acc0b27a6740f03639727be452f1e6b83">prio</a> : 0; <span class="comment">//idle task ist immer da mit pri 0</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    tcd[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>].<a class="code" href="structs__tcd.html#a0ff73b1428e9cd11a4f7a6cf46b7b550">timer</a>=0;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">//die parameter merken zum debuggen</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#ifdef ERTK_DEBUG</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    tcd[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>].param0= n ? 0 : <a class="code" href="e_r_t_k_8h.html#a975060be934fd5e6530ed4ddd6d17eee">rom_tcb</a>[n-1].<a class="code" href="structt__e_r_t_k__tcb.html#adf5dab6caf1bb8b15d0d08a6f0536d6a">param0</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    tcd[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>].param1= n ? 0 : <a class="code" href="e_r_t_k_8h.html#a975060be934fd5e6530ed4ddd6d17eee">rom_tcb</a>[n-1].<a class="code" href="structt__e_r_t_k__tcb.html#aa6baebda2f5c0d280a20b547849590f1">param1</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">//einsetzen der idle task, die muss immer da sein !</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  pTaskRdy=( <a class="code" href="structs__tcd.html">s_tcd</a> * )&amp;tcd[0];</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  pTaskRdy-&gt;<a class="code" href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">pnext</a>=NULL;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  pTaskRdy-&gt;<a class="code" href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">pbefore</a>=NULL;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">/* einsortieren der tasks mit verkettung nach absteigender prioritaet */</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordtype">char</span> hit[VANZTASK+1];</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  memset( hit, 0, <span class="keyword">sizeof</span> hit );</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">for</span>( task=1; task&lt;VANZTASK+1; task++ ) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    prio=0;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    index=0;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">for</span>( n=1; n&lt;VANZTASK+1; n++ ) { <span class="comment">//hoechstpriore ready und noch nicht verkettete task finden</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">if</span>( tcd[n].prio&gt;=prio &amp;&amp; !hit[n] ) { <span class="comment">/* prio&gt;prio und noch nicht in liste */</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        prio=tcd[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>].<a class="code" href="structs__tcd.html#acc0b27a6740f03639727be452f1e6b83">prio</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        index=<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;       }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;     }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="e_r_t_k_8c.html#a7ea5f3e666d805502c0f77d8e1cb7915">eRTK_SetReady</a>( index ); <span class="comment">//pTaskReady -&gt; tcdx -&gt; txdy -&gt; 0</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    hit[index]=1;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">for</span>( n=0; n&lt;VANZTASK+1; n++ ) { <span class="comment">/* SP der Tasks auf jeweiliges Stackende setzen */</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">for</span>( uint16_t f=0; f&lt;<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>/4; f++ ) memcpy( stack[n]+4*f, <span class="stringliteral">&quot;\xde\xad\xbe\xef&quot;</span>, 4 );</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">//memcpy( &amp;stack[n][214], &quot;0123456789abcdef0123456789ABCDEF&quot;, 32 );</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">/* startadressen und parameter auf den stack */</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-9]=0; <span class="comment">//r1=0</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      uint32_t ui32;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      uint8_t ui8[4];</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      void ( *task )( uint16_t param0, <span class="keywordtype">void</span> *param1 );</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      void ( *tvoid )( void );</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      void ( *tbeef )( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77">tsys</a> );</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;     } taddr;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    memset( &amp;taddr, 0, <span class="keyword">sizeof</span> taddr );</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    taddr.tbeef=<a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-1]=taddr.ui8[0];</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-2]=taddr.ui8[1];</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-3]=taddr.ui8[2];</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span>( n ) taddr.task=<a class="code" href="e_r_t_k_8h.html#a975060be934fd5e6530ed4ddd6d17eee">rom_tcb</a>[n-1].<a class="code" href="structt__e_r_t_k__tcb.html#a3775171fbe23e6e7effac90104258b55">task</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">else</span> taddr.tvoid=eRTK_Idle;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-4]=taddr.ui8[0];</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-5]=taddr.ui8[1];</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-6]=taddr.ui8[2];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">//                      hi  lo         hi  lo</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">//zwei parameter in p0=r25:r24 und p1=r23:r22</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span>( n ) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-32]=<a class="code" href="e_r_t_k_8h.html#a975060be934fd5e6530ed4ddd6d17eee">rom_tcb</a>[n-1].<a class="code" href="structt__e_r_t_k__tcb.html#adf5dab6caf1bb8b15d0d08a6f0536d6a">param0</a>&amp;0xff;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-33]=<a class="code" href="e_r_t_k_8h.html#a975060be934fd5e6530ed4ddd6d17eee">rom_tcb</a>[n-1].<a class="code" href="structt__e_r_t_k__tcb.html#adf5dab6caf1bb8b15d0d08a6f0536d6a">param0</a>&gt;&gt;8;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-30]=( uint16_t )( <a class="code" href="e_r_t_k_8h.html#a975060be934fd5e6530ed4ddd6d17eee">rom_tcb</a>[n-1].param1 )&amp;0xff;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-31]=( uint16_t )( <a class="code" href="e_r_t_k_8h.html#a975060be934fd5e6530ed4ddd6d17eee">rom_tcb</a>[n-1].param1 )&gt;&gt;8;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;     }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    stackptr[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>]=&amp;stack[<a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>][<a class="code" href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a>-40];</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="code" href="e_r_t_k_8c.html#ac4ea8d578bfd6abe49586e1f0c502855">sema_init</a>();</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">  Ein Prozess holt den aktuellen Zaehlerstand in ms mit eRTK_GetTimer().</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">  Wenn er in 10ms erneut starten will, kann er folgendes tun:</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">    uint8_t now=eRTK_GetTimer();</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">    ...do something</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">    eRTK_WaitUntil( now+10 );</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="keyword">union </span>{</div>
<div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a3ba0f593733c995fee31e8be6f19bd55">  453</a></span>&#160;  <span class="keyword">volatile</span> uint8_t <a class="code" href="e_r_t_k_8c.html#a3ba0f593733c995fee31e8be6f19bd55">timer8</a>[2];</div>
<div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a6da9cc15eee6ddc19ed8026cd1695395">  454</a></span>&#160;  <span class="keyword">volatile</span> uint16_t <a class="code" href="e_r_t_k_8c.html#a6da9cc15eee6ddc19ed8026cd1695395">timer16</a>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; } <a class="code" href="e_r_t_k_8c.html#a5de36e43c98e1ea1482953aadd37c9f9">eRTK_m_timer</a>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#aea14d6fc79ed1f9f12c4e91db2165e4c">  457</a></span>&#160;uint8_t <a class="code" href="e_r_t_k_8c.html#aea14d6fc79ed1f9f12c4e91db2165e4c">eRTK_GetTimer8</a>( <span class="keywordtype">void</span> ) { <span class="comment">//256ms bis overflow</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="e_r_t_k_8c.html#a5de36e43c98e1ea1482953aadd37c9f9">eRTK_m_timer</a>.timer8[0];</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#a17caad7a53ef1916393922a15f1aa325">  461</a></span>&#160;uint16_t <a class="code" href="e_r_t_k_8c.html#a17caad7a53ef1916393922a15f1aa325">eRTK_GetTimer16</a>( <span class="keywordtype">void</span> ) { <span class="comment">//wenn 256ms nicht reichen</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keyword">register</span> uint16_t val;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  ATOMIC_BLOCK( ATOMIC_RESTORESTATE ) {     </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    val=<a class="code" href="e_r_t_k_8c.html#a5de36e43c98e1ea1482953aadd37c9f9">eRTK_m_timer</a>.timer16;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#aaee1c3a6769446cecf3509ef02c236a9">  469</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#aaee1c3a6769446cecf3509ef02c236a9">eRTK_WaitUntil</a>( uint8_t then ) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <a class="code" href="e_r_t_k_8c.html#a3d802070bf824d2fadeda7297e158d32">eRTK_wefet</a>( then-<a class="code" href="e_r_t_k_8c.html#aea14d6fc79ed1f9f12c4e91db2165e4c">eRTK_GetTimer8</a>() );</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="e_r_t_k_8c.html#a4aa89b01a30bae72c6046aefc91072fa">  474</a></span>&#160;__inline__ <span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#a023ca68d8f937e79d0a90d22144fe3a1">__attribute__</a> ( ( always_inline ) ) eRTK_timertick( <span class="keywordtype">void</span> ) { <span class="comment">//damit im irq alle register gesichert werden</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <a class="code" href="e_r_t_k_8h.html#a3d61c5457dc8a3e2905d426f3581207e">oIDLE</a>( 0 );</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keywordflow">if</span>( eRTK_ticks&lt;65535u ) ++<a class="code" href="e_r_t_k_8c.html#a4800cc7a9b075006ac86ec1cfb1e3988">eRTK_ticks</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  ++<a class="code" href="e_r_t_k_8c.html#a5de36e43c98e1ea1482953aadd37c9f9">eRTK_m_timer</a>.timer16;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <a class="code" href="structs__tcd.html">s_tcd</a> *p=<a class="code" href="e_r_t_k_8c.html#a41c229f999d1607dd3f54b7d0b8a18cc">tcd</a>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="comment">//timer service</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">for</span>( uint8_t <a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>=0; <a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>&lt;<a class="code" href="e_r_t_k_8h.html#ab3cb102afd3b038d1a336dfebb4521ea">VANZTASK</a>+1; <a class="code" href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a>++ ) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">if</span>( p-&gt;<a class="code" href="structs__tcd.html#a0ff73b1428e9cd11a4f7a6cf46b7b550">timer</a> ) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordflow">if</span>( !--p-&gt;<a class="code" href="structs__tcd.html#a0ff73b1428e9cd11a4f7a6cf46b7b550">timer</a> ) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="e_r_t_k_8c.html#a7ea5f3e666d805502c0f77d8e1cb7915">eRTK_SetReady</a>( p-&gt;<a class="code" href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">tid</a> );</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;       }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;     }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    ++p;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">if</span>( eRTK_up &amp;&amp; eRTK_ticks&gt;<a class="code" href="e_r_t_k_8h.html#a4ac1139ee0e3e9d2d8ad8f2d344c7a74">eRTK_STARTUP_MS</a> ) { <span class="comment">//solange geben wir dem system zum hochlauf</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    eRTK_perfcounter[ ( eRTK_iperf++ )<span class="comment">/*&amp;0x0f*/</span> ]=eRTK_perfcount;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span>( eRTK_perfcount&lt;1 ) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      ++<a class="code" href="e_r_t_k_8c.html#a05d77a5f8b9d931a0263a9c07e21f20b">eRTK_cnt_overload</a>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="e_r_t_k_8h.html#aeeb76ef40a906d343ff39ac86d404e69">eRTK_MAX_OVERLOAD</a> &amp;&amp; eRTK_cnt_overload&gt;<a class="code" href="e_r_t_k_8h.html#aeeb76ef40a906d343ff39ac86d404e69">eRTK_MAX_OVERLOAD</a> ) <a class="code" href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a>( <a class="code" href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a2ac761806f7383d4153ec4a2606ffd0b">SYS_OVERLOAD</a> ); </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;     }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">else</span> eRTK_cnt_overload=0;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    eRTK_perfcount=0;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">if</span>( eRTK_up ) eRTK_scheduler();</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor">#if defined (__AVR_ATmega2560__)</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<a class="code" href="uart_8c.html#a084f0a9cf05b1877bd8a71a90dae7ff8">ISR</a>( TIMER0_OVF_vect ) { <span class="comment">//1kHz timer</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  TCNT0=( uint8_t )( -1*<a class="code" href="e_r_t_k_8h.html#abc2979492e4d5b0bb092a49a057ee92a">TIMERPRELOAD</a> );</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  eRTK_timertick();</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <a class="code" href="adc_8h.html#a5dc01ce4b556dc55a0d152344937eae3">adc_sequencer</a>();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> timer0_init( <span class="keywordtype">void</span> ) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  TCCR0B=<span class="comment">/*(1&lt;&lt;CS12)|*/</span>(1&lt;&lt;CS01)|(1&lt;&lt;CS00); <span class="comment">//prescaler CLK/64</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  TIMSK0|=(1&lt;&lt;TOIE0);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  TCNT0=( uint8_t )( -1*<a class="code" href="e_r_t_k_8h.html#abc2979492e4d5b0bb092a49a057ee92a">TIMERPRELOAD</a> );</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="e_r_t_k_8h.html#af4244078f421e8b74a28baa8106bb3a7">  515</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="e_r_t_k_8c.html#af4244078f421e8b74a28baa8106bb3a7">eRTK_timer_init</a>( <span class="keywordtype">void</span> ) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">#if defined (__AVR_ATmega2560__)</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  timer0_init();</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">#elif defined (__AVR_ATxmega128A1U__)</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">#if eRTKTEST</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;uint16_t loop1, loop2;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordtype">void</span> TMain1( uint16_t param0, <span class="keywordtype">void</span> *param1 ) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  uint16_t p0=param0;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  uint16_t p1=param1;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">while</span>( 1 ) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    uint8_t now=eRTK_GetTimer();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    uint32_t cnt;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">for</span>( cnt=0; cnt&lt;1000; cnt++ );</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <a class="code" href="e_r_t_k_8c.html#aaee1c3a6769446cecf3509ef02c236a9">eRTK_WaitUntil</a>( now+10 );</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">while</span>( 0 ) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="e_r_t_k_8c.html#a1760711232ae117710d963736158d5b1">eRTK_get_sema</a>( 0 );</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    write0( ( uint8_t* )<span class="stringliteral">&quot;1234567890&quot;</span>, 10 );</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="e_r_t_k_8c.html#a17cb0c621d1b778f1d2ea451ee05b5d5">eRTK_free_sema</a>( 0 );</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">while</span>( 1 ) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordtype">char</span> tmp[100];</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    strcpy( tmp, <span class="stringliteral">&quot;12345678901234567890123456789012345678901234567890&quot;</span> );</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordflow">while</span>( 1 ) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="e_r_t_k_8c.html#a3d802070bf824d2fadeda7297e158d32">eRTK_wefet</a>( 1 );</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    ++loop1;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="e_r_t_k_8c.html#a3d802070bf824d2fadeda7297e158d32">eRTK_wefet</a>( 1 );</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    --loop1;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="keywordtype">void</span> TMain2( uint16_t param0, <span class="keywordtype">void</span> *param1 ) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  uint16_t p0=param0;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  uint16_t p1=param1;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">while</span>( 0 ) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="e_r_t_k_8c.html#a1760711232ae117710d963736158d5b1">eRTK_get_sema</a>( 0 );</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    write0( ( uint8_t* )<span class="stringliteral">&quot;abcdefghij&quot;</span>, 10 );</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="e_r_t_k_8c.html#a17cb0c621d1b778f1d2ea451ee05b5d5">eRTK_free_sema</a>( 0 );</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">while</span>( 1 ) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordtype">char</span> tmp[100];</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      strcpy( tmp, <span class="stringliteral">&quot;abcdefghijklabcdefghijklabcdefghijklabcdefghijkl&quot;</span> );</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">while</span>( 1 ) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="e_r_t_k_8c.html#a3d802070bf824d2fadeda7297e158d32">eRTK_wefet</a>( 1 );</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    ++loop2;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="e_r_t_k_8c.html#a3d802070bf824d2fadeda7297e158d32">eRTK_wefet</a>( 1 );</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    --loop2;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="e_r_t_k_8c_html_a3ba0f593733c995fee31e8be6f19bd55"><div class="ttname"><a href="e_r_t_k_8c.html#a3ba0f593733c995fee31e8be6f19bd55">timer8</a></div><div class="ttdeci">volatile uint8_t timer8[2]</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00453">eRTK.c:453</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_ac1f7652b7dcfdf546cc32354bc65274c"><div class="ttname"><a href="e_r_t_k_8c.html#ac1f7652b7dcfdf546cc32354bc65274c">ANZSEMA</a></div><div class="ttdeci">#define ANZSEMA</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00294">eRTK.c:294</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_aea14d6fc79ed1f9f12c4e91db2165e4c"><div class="ttname"><a href="e_r_t_k_8c.html#aea14d6fc79ed1f9f12c4e91db2165e4c">eRTK_GetTimer8</a></div><div class="ttdeci">uint8_t eRTK_GetTimer8(void)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00457">eRTK.c:457</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a42910d588a38ca0fca7d0897a715fdad"><div class="ttname"><a href="e_r_t_k_8c.html#a42910d588a38ca0fca7d0897a715fdad">eRTK_go</a></div><div class="ttdeci">void eRTK_go(void)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00151">eRTK.c:151</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_aeeb76ef40a906d343ff39ac86d404e69"><div class="ttname"><a href="e_r_t_k_8h.html#aeeb76ef40a906d343ff39ac86d404e69">eRTK_MAX_OVERLOAD</a></div><div class="ttdeci">#define eRTK_MAX_OVERLOAD</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00030">eRTK.h:30</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a09970f0903edf40a2a54074eebc038e6"><div class="ttname"><a href="e_r_t_k_8c.html#a09970f0903edf40a2a54074eebc038e6">eRTK_GetTid</a></div><div class="ttdeci">uint8_t eRTK_GetTid(void)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00233">eRTK.c:233</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_ab0ab7b20efeb07bcadddc4400440cb3a"><div class="ttname"><a href="e_r_t_k_8c.html#ab0ab7b20efeb07bcadddc4400440cb3a">n</a></div><div class="ttdeci">push r0 npush r1 npush r2 npush r3 npush r4 npush r5 npush r6 npush r7 npush r8 npush r9 npush r10 npush r11 npush r12 npush r13 npush r14 npush r15 npush r16 npush r17 npush r18 npush r19 npush r20 npush r21 npush r22 npush r23 npush r24 npush r25 npush r26 npush r27 npush r28 npush r29 npush r30 npush r31 n in __SP_L__ n sts r0 n in __SP_H__ n sts r0 n</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00093">eRTK.c:93</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a41c229f999d1607dd3f54b7d0b8a18cc"><div class="ttname"><a href="e_r_t_k_8c.html#a41c229f999d1607dd3f54b7d0b8a18cc">tcd</a></div><div class="ttdeci">s_tcd tcd[VANZTASK+1]</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00038">eRTK.c:38</a></div></div>
<div class="ttc" id="structs__tcd_html_a6f1dddf458f4e57fe3444309a958c73a"><div class="ttname"><a href="structs__tcd.html#a6f1dddf458f4e57fe3444309a958c73a">s_tcd::tid</a></div><div class="ttdeci">uint8_t tid</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00030">eRTK.c:30</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_ac0c35182aeab65219bdf56d0f7d37aa0"><div class="ttname"><a href="e_r_t_k_8c.html#ac0c35182aeab65219bdf56d0f7d37aa0">eRTK_Sleep_ms</a></div><div class="ttdeci">void eRTK_Sleep_ms(uint16_t ms)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00280">eRTK.c:280</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a3d802070bf824d2fadeda7297e158d32"><div class="ttname"><a href="e_r_t_k_8c.html#a3d802070bf824d2fadeda7297e158d32">eRTK_wefet</a></div><div class="ttdeci">void eRTK_wefet(uint8_t timeout)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00269">eRTK.c:269</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a6c892b8dd5b4f853e95f4b0646d299e6"><div class="ttname"><a href="e_r_t_k_8c.html#a6c892b8dd5b4f853e95f4b0646d299e6">eRTK_iperf</a></div><div class="ttdeci">volatile uint8_t eRTK_iperf</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00055">eRTK.c:55</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a1760711232ae117710d963736158d5b1"><div class="ttname"><a href="e_r_t_k_8c.html#a1760711232ae117710d963736158d5b1">eRTK_get_sema</a></div><div class="ttdeci">void eRTK_get_sema(uint8_t semaid)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00309">eRTK.c:309</a></div></div>
<div class="ttc" id="structs__tcd_html"><div class="ttname"><a href="structs__tcd.html">s_tcd</a></div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00027">eRTK.c:27</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_a6fb8ccd426385b52e6ece9e1485017bc"><div class="ttname"><a href="e_r_t_k_8h.html#a6fb8ccd426385b52e6ece9e1485017bc">ERTK_STACKSIZE</a></div><div class="ttdeci">#define ERTK_STACKSIZE</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00032">eRTK.h:32</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a4800cc7a9b075006ac86ec1cfb1e3988"><div class="ttname"><a href="e_r_t_k_8c.html#a4800cc7a9b075006ac86ec1cfb1e3988">eRTK_ticks</a></div><div class="ttdeci">volatile uint16_t eRTK_ticks</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00056">eRTK.c:56</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_ac4ea8d578bfd6abe49586e1f0c502855"><div class="ttname"><a href="e_r_t_k_8c.html#ac4ea8d578bfd6abe49586e1f0c502855">sema_init</a></div><div class="ttdeci">void sema_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00322">eRTK.c:322</a></div></div>
<div class="ttc" id="uart_8c_html_a084f0a9cf05b1877bd8a71a90dae7ff8"><div class="ttname"><a href="uart_8c.html#a084f0a9cf05b1877bd8a71a90dae7ff8">ISR</a></div><div class="ttdeci">ISR(USART0_RX_vect)</div><div class="ttdef"><b>Definition:</b> <a href="uart_8c_source.html#l00104">uart.c:104</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a8fe81059bd63b9c331b9cef3af5592ac"><div class="ttname"><a href="e_r_t_k_8c.html#a8fe81059bd63b9c331b9cef3af5592ac">eRTK_perfcount</a></div><div class="ttdeci">volatile uint16_t eRTK_perfcount</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00053">eRTK.c:53</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_a015273ea14d0c2a5a1a41fa4189ef151"><div class="ttname"><a href="e_r_t_k_8h.html#a015273ea14d0c2a5a1a41fa4189ef151">oIDLEfast</a></div><div class="ttdeci">#define oIDLEfast(a)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00042">eRTK.h:42</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a61c66c5448e8a03934ca76279b767b2a"><div class="ttname"><a href="e_r_t_k_8c.html#a61c66c5448e8a03934ca76279b767b2a">pTaskRdy</a></div><div class="ttdeci">s_tcd * pTaskRdy</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00040">eRTK.c:40</a></div></div>
<div class="ttc" id="structt__e_r_t_k__tcb_html_a3775171fbe23e6e7effac90104258b55"><div class="ttname"><a href="structt__e_r_t_k__tcb.html#a3775171fbe23e6e7effac90104258b55">t_eRTK_tcb::task</a></div><div class="ttdeci">void(* task)(uint16_t param0, void *param1)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00068">eRTK.h:68</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_ab3cb102afd3b038d1a336dfebb4521ea"><div class="ttname"><a href="e_r_t_k_8h.html#ab3cb102afd3b038d1a336dfebb4521ea">VANZTASK</a></div><div class="ttdeci">#define VANZTASK</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00015">eRTK.h:15</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a3631624090b7ea09b3a64993b9c979e7"><div class="ttname"><a href="e_r_t_k_8c.html#a3631624090b7ea09b3a64993b9c979e7">eRTK_init</a></div><div class="ttdeci">void eRTK_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00371">eRTK.c:371</a></div></div>
<div class="ttc" id="adc_8h_html"><div class="ttname"><a href="adc_8h.html">adc.h</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_a42e6a9b399a63d5344a5d91d24f6bf77aae3becb60d64378eb6639c6e0f3ad24b"><div class="ttname"><a href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77aae3becb60d64378eb6639c6e0f3ad24b">SYS_NOTASK</a></div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00050">eRTK.h:50</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_abc2979492e4d5b0bb092a49a057ee92a"><div class="ttname"><a href="e_r_t_k_8h.html#abc2979492e4d5b0bb092a49a057ee92a">TIMERPRELOAD</a></div><div class="ttdeci">#define TIMERPRELOAD</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00021">eRTK.h:21</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_a42e6a9b399a63d5344a5d91d24f6bf77a887fd82bac500521b5e2e0d10cc1ba40"><div class="ttname"><a href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a887fd82bac500521b5e2e0d10cc1ba40">SYS_VERIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00050">eRTK.h:50</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_a4ac1139ee0e3e9d2d8ad8f2d344c7a74"><div class="ttname"><a href="e_r_t_k_8h.html#a4ac1139ee0e3e9d2d8ad8f2d344c7a74">eRTK_STARTUP_MS</a></div><div class="ttdeci">#define eRTK_STARTUP_MS</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00029">eRTK.h:29</a></div></div>
<div class="ttc" id="structs__tcd_html_a3fadec2bef4ae8faba444c8cc5c1a227"><div class="ttname"><a href="structs__tcd.html#a3fadec2bef4ae8faba444c8cc5c1a227">s_tcd::pnext</a></div><div class="ttdeci">struct s_tcd * pnext</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00028">eRTK.c:28</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_aaee1c3a6769446cecf3509ef02c236a9"><div class="ttname"><a href="e_r_t_k_8c.html#aaee1c3a6769446cecf3509ef02c236a9">eRTK_WaitUntil</a></div><div class="ttdeci">void eRTK_WaitUntil(uint8_t then)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00469">eRTK.c:469</a></div></div>
<div class="ttc" id="structt__e_r_t_k__tcb_html_acc0b27a6740f03639727be452f1e6b83"><div class="ttname"><a href="structt__e_r_t_k__tcb.html#acc0b27a6740f03639727be452f1e6b83">t_eRTK_tcb::prio</a></div><div class="ttdeci">uint8_t prio</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00069">eRTK.h:69</a></div></div>
<div class="ttc" id="structs__tcd_html_a9ed3ee6f25f7cfa519dfbcbb72135f8e"><div class="ttname"><a href="structs__tcd.html#a9ed3ee6f25f7cfa519dfbcbb72135f8e">s_tcd::pbefore</a></div><div class="ttdeci">struct s_tcd * pbefore</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00029">eRTK.c:29</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_aa6f1a6f9166129ed5bd9dc8989cb0dbe"><div class="ttname"><a href="e_r_t_k_8c.html#aa6f1a6f9166129ed5bd9dc8989cb0dbe">s_tcd</a></div><div class="ttdeci">struct s_tcd s_tcd</div></div>
<div class="ttc" id="e_r_t_k_8h_html_a3d61c5457dc8a3e2905d426f3581207e"><div class="ttname"><a href="e_r_t_k_8h.html#a3d61c5457dc8a3e2905d426f3581207e">oIDLE</a></div><div class="ttdeci">#define oIDLE(a)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00041">eRTK.h:41</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a6f37965512a76bfcf60c294b780f1fe0"><div class="ttname"><a href="e_r_t_k_8c.html#a6f37965512a76bfcf60c294b780f1fe0">pp_stack</a></div><div class="ttdeci">void * pp_stack</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00085">eRTK.c:85</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a05d77a5f8b9d931a0263a9c07e21f20b"><div class="ttname"><a href="e_r_t_k_8c.html#a05d77a5f8b9d931a0263a9c07e21f20b">eRTK_cnt_overload</a></div><div class="ttdeci">volatile uint8_t eRTK_cnt_overload</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00057">eRTK.c:57</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a26b5f9d5385bb6bc6cb37ef2b654658a"><div class="ttname"><a href="e_r_t_k_8c.html#a26b5f9d5385bb6bc6cb37ef2b654658a">eRTK_up</a></div><div class="ttdeci">volatile uint8_t eRTK_up</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00052">eRTK.c:52</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a7ea5f3e666d805502c0f77d8e1cb7915"><div class="ttname"><a href="e_r_t_k_8c.html#a7ea5f3e666d805502c0f77d8e1cb7915">eRTK_SetReady</a></div><div class="ttdeci">void eRTK_SetReady(uint8_t tid)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00238">eRTK.c:238</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_a8a6bae5404d98108aa2392f69b27b983"><div class="ttname"><a href="e_r_t_k_8h.html#a8a6bae5404d98108aa2392f69b27b983">deadbeef</a></div><div class="ttdeci">void deadbeef(tsys reason)</div></div>
<div class="ttc" id="e_r_t_k_8h_html_a42e6a9b399a63d5344a5d91d24f6bf77a527512c0cf5a8a3ae6a2f83d31764467"><div class="ttname"><a href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a527512c0cf5a8a3ae6a2f83d31764467">SYS_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00050">eRTK.h:50</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a023ca68d8f937e79d0a90d22144fe3a1"><div class="ttname"><a href="e_r_t_k_8c.html#a023ca68d8f937e79d0a90d22144fe3a1">__attribute__</a></div><div class="ttdeci">uint8_t stack[VANZTASK+1][ERTK_STACKSIZE] __attribute__((aligned(256)))</div></div>
<div class="ttc" id="e_r_t_k_8h_html_a42e6a9b399a63d5344a5d91d24f6bf77a2ac761806f7383d4153ec4a2606ffd0b"><div class="ttname"><a href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a2ac761806f7383d4153ec4a2606ffd0b">SYS_OVERLOAD</a></div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00050">eRTK.h:50</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a36551d0cc20561200d962fd673baf747"><div class="ttname"><a href="e_r_t_k_8c.html#a36551d0cc20561200d962fd673baf747">akttask</a></div><div class="ttdeci">volatile uint8_t akttask</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00024">eRTK.c:24</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_a42e6a9b399a63d5344a5d91d24f6bf77a8581699208d8eafcc5cbd0b62b932765"><div class="ttname"><a href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77a8581699208d8eafcc5cbd0b62b932765">SYS_NULLPTR</a></div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00050">eRTK.h:50</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_aa63d7b8eeb6b2a9b10664b54f6e78e55"><div class="ttname"><a href="e_r_t_k_8c.html#aa63d7b8eeb6b2a9b10664b54f6e78e55">eRTK_SetSuspended</a></div><div class="ttdeci">void eRTK_SetSuspended(uint8_t tid)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00255">eRTK.c:255</a></div></div>
<div class="ttc" id="structs__tcd_html_a0ff73b1428e9cd11a4f7a6cf46b7b550"><div class="ttname"><a href="structs__tcd.html#a0ff73b1428e9cd11a4f7a6cf46b7b550">s_tcd::timer</a></div><div class="ttdeci">uint8_t timer</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00032">eRTK.c:32</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html"><div class="ttname"><a href="e_r_t_k_8h.html">eRTK.h</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a5de36e43c98e1ea1482953aadd37c9f9"><div class="ttname"><a href="e_r_t_k_8c.html#a5de36e43c98e1ea1482953aadd37c9f9">eRTK_m_timer</a></div><div class="ttdeci">union @0 eRTK_m_timer</div></div>
<div class="ttc" id="structt__e_r_t_k__tcb_html_aa6baebda2f5c0d280a20b547849590f1"><div class="ttname"><a href="structt__e_r_t_k__tcb.html#aa6baebda2f5c0d280a20b547849590f1">t_eRTK_tcb::param1</a></div><div class="ttdeci">void * param1</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00071">eRTK.h:71</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_af4244078f421e8b74a28baa8106bb3a7"><div class="ttname"><a href="e_r_t_k_8c.html#af4244078f421e8b74a28baa8106bb3a7">eRTK_timer_init</a></div><div class="ttdeci">void eRTK_timer_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00515">eRTK.c:515</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_aab934edff3f692e18b7a5f6d1a5c6f80"><div class="ttname"><a href="e_r_t_k_8c.html#aab934edff3f692e18b7a5f6d1a5c6f80">eRTK_perfcounter</a></div><div class="ttdeci">volatile uint16_t eRTK_perfcounter[256]</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00054">eRTK.c:54</a></div></div>
<div class="ttc" id="e_r_t_k_8h_html_a975060be934fd5e6530ed4ddd6d17eee"><div class="ttname"><a href="e_r_t_k_8h.html#a975060be934fd5e6530ed4ddd6d17eee">rom_tcb</a></div><div class="ttdeci">const t_eRTK_tcb rom_tcb[VANZTASK]</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00090">main.c:90</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a8d80a94387da2f651c867b136f13e585"><div class="ttname"><a href="e_r_t_k_8c.html#a8d80a94387da2f651c867b136f13e585">stackptr</a></div><div class="ttdeci">void * stackptr[VANZTASK+1]</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00022">eRTK.c:22</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a17cb0c621d1b778f1d2ea451ee05b5d5"><div class="ttname"><a href="e_r_t_k_8c.html#a17cb0c621d1b778f1d2ea451ee05b5d5">eRTK_free_sema</a></div><div class="ttdeci">void eRTK_free_sema(uint8_t semaid)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00317">eRTK.c:317</a></div></div>
<div class="ttc" id="adc_8h_html_a5dc01ce4b556dc55a0d152344937eae3"><div class="ttname"><a href="adc_8h.html#a5dc01ce4b556dc55a0d152344937eae3">adc_sequencer</a></div><div class="ttdeci">uint8_t adc_sequencer(void)</div></div>
<div class="ttc" id="e_r_t_k_8h_html_a42e6a9b399a63d5344a5d91d24f6bf77"><div class="ttname"><a href="e_r_t_k_8h.html#a42e6a9b399a63d5344a5d91d24f6bf77">tsys</a></div><div class="ttdeci">tsys</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00050">eRTK.h:50</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a17caad7a53ef1916393922a15f1aa325"><div class="ttname"><a href="e_r_t_k_8c.html#a17caad7a53ef1916393922a15f1aa325">eRTK_GetTimer16</a></div><div class="ttdeci">uint16_t eRTK_GetTimer16(void)</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00461">eRTK.c:461</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_ae325ea7e04e372ce84d5b9bcbc86bd1c"><div class="ttname"><a href="e_r_t_k_8c.html#ae325ea7e04e372ce84d5b9bcbc86bd1c">push</a></div><div class="ttdeci">#define push()</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00087">eRTK.c:87</a></div></div>
<div class="ttc" id="structs__tcd_html_acc0b27a6740f03639727be452f1e6b83"><div class="ttname"><a href="structs__tcd.html#acc0b27a6740f03639727be452f1e6b83">s_tcd::prio</a></div><div class="ttdeci">uint8_t prio</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00031">eRTK.c:31</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_abfba97ff1c115a2b0c3911c0c781f697"><div class="ttname"><a href="e_r_t_k_8c.html#abfba97ff1c115a2b0c3911c0c781f697">pop</a></div><div class="ttdeci">#define pop()</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00101">eRTK.c:101</a></div></div>
<div class="ttc" id="e_r_t_k_8c_html_a6da9cc15eee6ddc19ed8026cd1695395"><div class="ttname"><a href="e_r_t_k_8c.html#a6da9cc15eee6ddc19ed8026cd1695395">timer16</a></div><div class="ttdeci">volatile uint16_t timer16</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8c_source.html#l00454">eRTK.c:454</a></div></div>
<div class="ttc" id="structt__e_r_t_k__tcb_html_adf5dab6caf1bb8b15d0d08a6f0536d6a"><div class="ttname"><a href="structt__e_r_t_k__tcb.html#adf5dab6caf1bb8b15d0d08a6f0536d6a">t_eRTK_tcb::param0</a></div><div class="ttdeci">uint16_t param0</div><div class="ttdef"><b>Definition:</b> <a href="e_r_t_k_8h_source.html#l00070">eRTK.h:70</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 11 2015 09:59:59 for eRTK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
